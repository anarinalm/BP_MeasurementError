<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Tutorial of Measurement Error Methods for Evaluating Blood Pressure using NHANES Data - 6&nbsp; Regression Calibration</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./add_noise.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./reg_cal.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regression Calibration</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Tutorial of Measurement Error Methods for Evaluating Blood Pressure using NHANES Data</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./initial_modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modeling Diabetes Occurrence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./diagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Model Diagnostics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./add_noise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Creating “Noisy” Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reg_cal.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regression Calibration</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#simple-regression" id="toc-simple-regression" class="nav-link active" data-scroll-target="#simple-regression"><span class="header-section-number">7</span> Simple Regression</a>
  <ul class="collapse">
  <li><a href="#naive-analysis" id="toc-naive-analysis" class="nav-link" data-scroll-target="#naive-analysis"><span class="header-section-number">7.1</span> Naive Analysis</a></li>
  <li><a href="#gold-standard-analysis" id="toc-gold-standard-analysis" class="nav-link" data-scroll-target="#gold-standard-analysis"><span class="header-section-number">7.2</span> Gold Standard Analysis</a></li>
  <li><a href="#regression-calibration" id="toc-regression-calibration" class="nav-link" data-scroll-target="#regression-calibration"><span class="header-section-number">7.3</span> Regression Calibration</a></li>
  </ul></li>
  <li><a href="#selected-model-regression" id="toc-selected-model-regression" class="nav-link" data-scroll-target="#selected-model-regression"><span class="header-section-number">8</span> Selected Model Regression</a>
  <ul class="collapse">
  <li><a href="#naive-analysis-1" id="toc-naive-analysis-1" class="nav-link" data-scroll-target="#naive-analysis-1"><span class="header-section-number">8.1</span> Naive Analysis</a></li>
  <li><a href="#gold-standard-analysis-1" id="toc-gold-standard-analysis-1" class="nav-link" data-scroll-target="#gold-standard-analysis-1"><span class="header-section-number">8.2</span> Gold Standard Analysis</a></li>
  <li><a href="#regression-calibration-1" id="toc-regression-calibration-1" class="nav-link" data-scroll-target="#regression-calibration-1"><span class="header-section-number">8.3</span> Regression Calibration</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regression Calibration</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot) <span class="co"># for bootstrap SE</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#using data specified in this github repository:</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">"jhs-hwg/cardioStatsUSA"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cardioStatsUSA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Read in the subset data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>subset_nhanes <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"nhanes_subset.rds"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(subset_nhanes<span class="sc">$</span>demo_race)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Non-Hispanic White Non-Hispanic Black Non-Hispanic Asian           Hispanic 
               253                128                 36                155 
             Other 
                28 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(subset_nhanes<span class="sc">$</span>demo_gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  Men Women 
  277   323 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(subset_nhanes<span class="sc">$</span>demo_age_years)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 
 5  7 12  7 11 11 15  9 10  7  5  4 14 11 10 13 10 14 11  8  9 12 10 11  8 13 
44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 
18 18 11  9  3 10  2 11  9  9  5 13  7 14  8 12 15 12 13 12 10  3 10  5  9  6 
70 71 72 73 74 75 76 77 78 79 80 
 8  4  9  7  4  3  7  6  3  4 34 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(subset_nhanes<span class="sc">$</span>cc_smoke)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  Never  Former Current 
    344     131     125 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(subset_nhanes<span class="sc">$</span>cc_bmi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      &lt;25 25 to &lt;30 30 to &lt;35       35+ 
      191       175       126       108 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(subset_nhanes<span class="sc">$</span>bp_med_use)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 No Yes 
435 165 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(subset_nhanes<span class="sc">$</span>cc_diabetes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 No Yes 
522  78 </code></pre>
</div>
</div>
<section id="simple-regression" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Simple Regression</h1>
<section id="naive-analysis" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="naive-analysis"><span class="header-section-number">7.1</span> Naive Analysis</h2>
<p>Before starting with regression calibration, we first want to see what a model that only uses our noisy data looks like. We’ll use the same model formula as before (including age, race, smoking status etc.), the only difference being that we will use our error-full data, specifically the low reliability case.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>naive.model<span class="ot">=</span><span class="fu">glm</span>(cc_diabetes <span class="sc">~</span> bp_sys_mean_noise_low, <span class="at">family=</span><span class="st">"binomial"</span>, <span class="at">data=</span>subset_nhanes)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(naive.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cc_diabetes ~ bp_sys_mean_noise_low, family = "binomial", 
    data = subset_nhanes)

Coefficients:
                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           -2.519646   0.369018  -6.828 8.61e-12 ***
bp_sys_mean_noise_low  0.004826   0.002639   1.828   0.0675 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 463.66  on 599  degrees of freedom
Residual deviance: 460.29  on 598  degrees of freedom
AIC: 464.29

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">tidy</span>(naive.model, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 28%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.080</td>
<td style="text-align: right;">0.369</td>
<td style="text-align: right;">-6.828</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.162</td>
</tr>
<tr class="even">
<td style="text-align: left;">bp_sys_mean_noise_low</td>
<td style="text-align: right;">1.005</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">1.828</td>
<td style="text-align: right;">0.067</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.010</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Looking at the summary above, the significant coefficients, and therefore the variables which the model finds most useful in diabetes status prediction, are age, Non-Hispanic Black racial status, and BMI status, specifically for those in the 25 to 30 range. Note that our p value for our blood pressure variable is quite high, showing non-significance in the model.</p>
</section>
<section id="gold-standard-analysis" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="gold-standard-analysis"><span class="header-section-number">7.2</span> Gold Standard Analysis</h2>
<p>Next, we’ll look at our “true” model, the model which uses our unbiased, non-error blood pressure values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>true.model<span class="ot">=</span><span class="fu">glm</span>(cc_diabetes <span class="sc">~</span> bp_sys_mean, <span class="at">family=</span><span class="st">"binomial"</span>, <span class="at">data=</span>subset_nhanes)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(true.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cc_diabetes ~ bp_sys_mean, family = "binomial", 
    data = subset_nhanes)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -5.777250   0.787205  -7.339 2.15e-13 ***
bp_sys_mean  0.030330   0.005911   5.131 2.89e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 463.66  on 599  degrees of freedom
Residual deviance: 437.53  on 598  degrees of freedom
AIC: 441.53

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">tidy</span>(true.model, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">0.787</td>
<td style="text-align: right;">-7.339</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.014</td>
</tr>
<tr class="even">
<td style="text-align: left;">bp_sys_mean</td>
<td style="text-align: right;">1.031</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">5.131</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.019</td>
<td style="text-align: right;">1.043</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>For this subset of the data, the true beta value for the systolic mean is … This is much higher than the model which we looked at previously, using all ~50,000 subjects, although it is to be expected since we restricted the data to n=150 samples. Also notice that the significance level</p>
</section>
<section id="regression-calibration" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="regression-calibration"><span class="header-section-number">7.3</span> Regression Calibration</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a model with predicts the true BP value based on the noisy BP data</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>rcfit<span class="ot">&lt;-</span><span class="fu">lm</span>(bp_sys_mean <span class="sc">~</span> bp_sys_mean_noise_low, <span class="at">data=</span>subset_nhanes)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rcfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bp_sys_mean ~ bp_sys_mean_noise_low, data = subset_nhanes)

Residuals:
    Min      1Q  Median      3Q     Max 
-40.512 -12.063  -1.631   8.883  71.880 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           105.08228    2.04124  51.480   &lt;2e-16 ***
bp_sys_mean_noise_low   0.15067    0.01538   9.797   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 17.45 on 598 degrees of freedom
Multiple R-squared:  0.1383,    Adjusted R-squared:  0.1369 
F-statistic: 95.98 on 1 and 598 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>subset_nhanes<span class="sc">$</span>bp_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(rcfit, <span class="at">newdata=</span>subset_nhanes) </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>final.model <span class="ot">=</span> <span class="fu">glm</span>(cc_diabetes <span class="sc">~</span> bp_hat, <span class="at">family=</span><span class="st">"binomial"</span>,<span class="at">data=</span>subset_nhanes)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cc_diabetes ~ bp_hat, family = "binomial", data = subset_nhanes)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept) -5.88548    2.19259  -2.684  0.00727 **
bp_hat       0.03203    0.01752   1.828  0.06749 . 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 463.66  on 599  degrees of freedom
Residual deviance: 460.29  on 598  degrees of freedom
AIC: 464.29

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">tidy</span>(final.model, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">2.193</td>
<td style="text-align: right;">-2.684</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.196</td>
</tr>
<tr class="even">
<td style="text-align: left;">bp_hat</td>
<td style="text-align: right;">1.033</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">1.828</td>
<td style="text-align: right;">0.067</td>
<td style="text-align: right;">0.998</td>
<td style="text-align: right;">1.069</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Correlation between BP_noise and BP_hat:"</span>, <span class="fu">cor</span>(subset_nhanes<span class="sc">$</span>bp_sys_mean_noise_low, subset_nhanes<span class="sc">$</span>bp_hat)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Correlation between BP_noise and BP_hat: 0.999999999999997"</code></pre>
</div>
</div>
<p>Fix Standard Errors:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#warning = False</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">43</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>bootstrap.functionV2<span class="ot">&lt;-</span><span class="cf">function</span>(dat,inds){</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    subset_nhanes.boot<span class="ot">&lt;-</span>dat[inds,]</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    rcfit.boot<span class="ot">&lt;-</span><span class="fu">lm</span>(bp_sys_mean <span class="sc">~</span> bp_sys_mean_noise_low, <span class="at">data=</span>subset_nhanes.boot)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    subset_nhanes.boot<span class="sc">$</span>bp_hat<span class="ot">&lt;-</span><span class="fu">predict</span>(rcfit.boot,<span class="at">newdata=</span>subset_nhanes.boot)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    final.model<span class="ot">=</span> <span class="fu">glm</span>(cc_diabetes <span class="sc">~</span> bp_hat, <span class="at">family=</span><span class="st">"binomial"</span>, <span class="at">data=</span>subset_nhanes.boot)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(final.model<span class="sc">$</span>coef)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>my.boot<span class="ot">&lt;-</span><span class="fu">boot</span>(subset_nhanes, bootstrap.functionV2, <span class="at">R=</span><span class="dv">500</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>bsSD <span class="ot">&lt;-</span> <span class="fu">apply</span>(my.boot<span class="sc">$</span>t,<span class="dv">2</span>,sd)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>bsSD</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.08979580 0.01666782</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>t.stat<span class="ot">&lt;-</span><span class="fu">coef</span>(final.model)<span class="sc">/</span>bsSD</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>t.stat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      bp_hat 
  -2.816292    1.921693 </code></pre>
</div>
</div>
<p>Now we can recalculate the p value for the bp_hat intercept using the t statistic calculated above. We can do this using the pt() function, which returns a p value based on a t statistic and degrees of freedom.</p>
<p>Since our alternative hypothesis in this case is ____ we set the lower.tail parameter to <strong>false</strong>?.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>p.value.bp <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(t.stat[<span class="st">'bp_hat'</span>]))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p.value.bp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    bp_hat 
0.05464444 </code></pre>
</div>
</div>
<p>Here, while we don’t recover a significant p value, we do have a lower p value compared to the naive analysis (0.055 vs 0.067). Therefore, we are more confident in our conclusion that blood pressure has a correlation to diabetes risk. In this case, we can interpret the results that for one additional unit increase in systolic blood pressure, the estimated risk of having diabetes increases by 3.3%.</p>
<p>We can also recalculate the confidence intervals: using the log odds value for the bp_hat intercept 1.033 and the recalculated standard errors, we can perform a simple calculation to construct the confidence interval at a level of 95%.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>conf.low <span class="ot">&lt;-</span> <span class="fl">1.033</span> <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span><span class="fl">0.01666782</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>conf.high <span class="ot">&lt;-</span> <span class="fl">1.033</span> <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span><span class="fl">0.01666782</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>conf.low</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.000331</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>conf.high</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.065669</code></pre>
</div>
</div>
<p>We see that the confidence interval does not cover 1, indicating that there is a strong evidence that a positive correlation between blood pressure and diabetes exists with a 95% confidence level.</p>
</section>
</section>
<section id="selected-model-regression" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Selected Model Regression</h1>
<section id="naive-analysis-1" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="naive-analysis-1"><span class="header-section-number">8.1</span> Naive Analysis</h2>
<p>Before starting with regression calibration, we first want to see what a model that only uses our noisy data looks like. We’ll use the same model formula as before (including age, race, smoking status etc.), the only difference being that we will use our error-full data, specifically the low reliability case.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>naive.model<span class="ot">=</span><span class="fu">glm</span>(cc_diabetes <span class="sc">~</span> bp_sys_mean_noise_low <span class="sc">+</span> demo_age_years <span class="sc">+</span> demo_gender <span class="sc">+</span> demo_race <span class="sc">+</span> cc_bmi <span class="sc">+</span> bp_med_use, <span class="at">family=</span><span class="st">"binomial"</span>, <span class="at">data=</span>subset_nhanes)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(naive.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cc_diabetes ~ bp_sys_mean_noise_low + demo_age_years + 
    demo_gender + demo_race + cc_bmi + bp_med_use, family = "binomial", 
    data = subset_nhanes)

Coefficients:
                             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                 -6.360537   0.810700  -7.846 4.30e-15 ***
bp_sys_mean_noise_low        0.001768   0.002926   0.604 0.545658    
demo_age_years               0.047772   0.010231   4.669 3.02e-06 ***
demo_genderWomen            -0.593300   0.278581  -2.130 0.033195 *  
demo_raceNon-Hispanic Black  0.861090   0.365695   2.355 0.018539 *  
demo_raceNon-Hispanic Asian  1.151863   0.708336   1.626 0.103917    
demo_raceHispanic            1.286503   0.341675   3.765 0.000166 ***
demo_raceOther               0.780841   0.814489   0.959 0.337716    
cc_bmi25 to &lt;30              0.650462   0.412058   1.579 0.114435    
cc_bmi30 to &lt;35              1.234393   0.436396   2.829 0.004675 ** 
cc_bmi35+                    1.861836   0.453735   4.103 4.07e-05 ***
bp_med_useYes                0.771081   0.308493   2.500 0.012437 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 463.66  on 599  degrees of freedom
Residual deviance: 368.59  on 588  degrees of freedom
AIC: 392.59

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">tidy</span>(naive.model, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 33%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.811</td>
<td style="text-align: right;">-7.846</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.008</td>
</tr>
<tr class="even">
<td style="text-align: left;">bp_sys_mean_noise_low</td>
<td style="text-align: right;">1.002</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">0.604</td>
<td style="text-align: right;">0.546</td>
<td style="text-align: right;">0.996</td>
<td style="text-align: right;">1.008</td>
</tr>
<tr class="odd">
<td style="text-align: left;">demo_age_years</td>
<td style="text-align: right;">1.049</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">4.669</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.029</td>
<td style="text-align: right;">1.071</td>
</tr>
<tr class="even">
<td style="text-align: left;">demo_genderWomen</td>
<td style="text-align: right;">0.553</td>
<td style="text-align: right;">0.279</td>
<td style="text-align: right;">-2.130</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">0.318</td>
<td style="text-align: right;">0.950</td>
</tr>
<tr class="odd">
<td style="text-align: left;">demo_raceNon-Hispanic Black</td>
<td style="text-align: right;">2.366</td>
<td style="text-align: right;">0.366</td>
<td style="text-align: right;">2.355</td>
<td style="text-align: right;">0.019</td>
<td style="text-align: right;">1.157</td>
<td style="text-align: right;">4.884</td>
</tr>
<tr class="even">
<td style="text-align: left;">demo_raceNon-Hispanic Asian</td>
<td style="text-align: right;">3.164</td>
<td style="text-align: right;">0.708</td>
<td style="text-align: right;">1.626</td>
<td style="text-align: right;">0.104</td>
<td style="text-align: right;">0.659</td>
<td style="text-align: right;">11.522</td>
</tr>
<tr class="odd">
<td style="text-align: left;">demo_raceHispanic</td>
<td style="text-align: right;">3.620</td>
<td style="text-align: right;">0.342</td>
<td style="text-align: right;">3.765</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.871</td>
<td style="text-align: right;">7.181</td>
</tr>
<tr class="even">
<td style="text-align: left;">demo_raceOther</td>
<td style="text-align: right;">2.183</td>
<td style="text-align: right;">0.814</td>
<td style="text-align: right;">0.959</td>
<td style="text-align: right;">0.338</td>
<td style="text-align: right;">0.319</td>
<td style="text-align: right;">9.110</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cc_bmi25 to &lt;30</td>
<td style="text-align: right;">1.916</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">1.579</td>
<td style="text-align: right;">0.114</td>
<td style="text-align: right;">0.870</td>
<td style="text-align: right;">4.434</td>
</tr>
<tr class="even">
<td style="text-align: left;">cc_bmi30 to &lt;35</td>
<td style="text-align: right;">3.436</td>
<td style="text-align: right;">0.436</td>
<td style="text-align: right;">2.829</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: right;">1.488</td>
<td style="text-align: right;">8.340</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cc_bmi35+</td>
<td style="text-align: right;">6.436</td>
<td style="text-align: right;">0.454</td>
<td style="text-align: right;">4.103</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">2.715</td>
<td style="text-align: right;">16.253</td>
</tr>
<tr class="even">
<td style="text-align: left;">bp_med_useYes</td>
<td style="text-align: right;">2.162</td>
<td style="text-align: right;">0.308</td>
<td style="text-align: right;">2.500</td>
<td style="text-align: right;">0.012</td>
<td style="text-align: right;">1.184</td>
<td style="text-align: right;">3.982</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Looking at the summary above, the significant coefficients, and therefore the variables which the model finds most useful in diabetes status prediction, are age, Non-Hispanic Black racial status, and BMI status, specifically for those in the 25 to 30 range. Note that our p value for our blood pressure variable is quite high, showing non-significance in the model.</p>
</section>
<section id="gold-standard-analysis-1" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="gold-standard-analysis-1"><span class="header-section-number">8.2</span> Gold Standard Analysis</h2>
<p>Next, we’ll look at our “true” model, the model which uses our unbiased, non-error blood pressure values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>true.model<span class="ot">=</span><span class="fu">glm</span>(cc_diabetes <span class="sc">~</span> bp_sys_mean <span class="sc">+</span> demo_age_years <span class="sc">+</span> demo_gender <span class="sc">+</span> demo_race <span class="sc">+</span> cc_bmi <span class="sc">+</span> bp_med_use, <span class="at">family=</span><span class="st">"binomial"</span>, <span class="at">data=</span>subset_nhanes)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(true.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cc_diabetes ~ bp_sys_mean + demo_age_years + demo_gender + 
    demo_race + cc_bmi + bp_med_use, family = "binomial", data = subset_nhanes)

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                 -8.03913    1.12566  -7.142 9.22e-13 ***
bp_sys_mean                  0.01700    0.00734   2.316 0.020570 *  
demo_age_years               0.04199    0.01058   3.969 7.21e-05 ***
demo_genderWomen            -0.61506    0.28041  -2.193 0.028273 *  
demo_raceNon-Hispanic Black  0.88094    0.36250   2.430 0.015091 *  
demo_raceNon-Hispanic Asian  1.19350    0.71337   1.673 0.094321 .  
demo_raceHispanic            1.29849    0.34264   3.790 0.000151 ***
demo_raceOther               0.83248    0.82019   1.015 0.310114    
cc_bmi25 to &lt;30              0.70851    0.41714   1.699 0.089413 .  
cc_bmi30 to &lt;35              1.28751    0.44345   2.903 0.003692 ** 
cc_bmi35+                    1.97864    0.46266   4.277 1.90e-05 ***
bp_med_useYes                0.68256    0.30655   2.227 0.025973 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 463.66  on 599  degrees of freedom
Residual deviance: 363.63  on 588  degrees of freedom
AIC: 387.63

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">tidy</span>(true.model, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 33%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.126</td>
<td style="text-align: right;">-7.142</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.003</td>
</tr>
<tr class="even">
<td style="text-align: left;">bp_sys_mean</td>
<td style="text-align: right;">1.017</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">2.316</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">1.003</td>
<td style="text-align: right;">1.032</td>
</tr>
<tr class="odd">
<td style="text-align: left;">demo_age_years</td>
<td style="text-align: right;">1.043</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">3.969</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.022</td>
<td style="text-align: right;">1.065</td>
</tr>
<tr class="even">
<td style="text-align: left;">demo_genderWomen</td>
<td style="text-align: right;">0.541</td>
<td style="text-align: right;">0.280</td>
<td style="text-align: right;">-2.193</td>
<td style="text-align: right;">0.028</td>
<td style="text-align: right;">0.309</td>
<td style="text-align: right;">0.932</td>
</tr>
<tr class="odd">
<td style="text-align: left;">demo_raceNon-Hispanic Black</td>
<td style="text-align: right;">2.413</td>
<td style="text-align: right;">0.362</td>
<td style="text-align: right;">2.430</td>
<td style="text-align: right;">0.015</td>
<td style="text-align: right;">1.188</td>
<td style="text-align: right;">4.951</td>
</tr>
<tr class="even">
<td style="text-align: left;">demo_raceNon-Hispanic Asian</td>
<td style="text-align: right;">3.299</td>
<td style="text-align: right;">0.713</td>
<td style="text-align: right;">1.673</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">0.682</td>
<td style="text-align: right;">12.160</td>
</tr>
<tr class="odd">
<td style="text-align: left;">demo_raceHispanic</td>
<td style="text-align: right;">3.664</td>
<td style="text-align: right;">0.343</td>
<td style="text-align: right;">3.790</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.889</td>
<td style="text-align: right;">7.279</td>
</tr>
<tr class="even">
<td style="text-align: left;">demo_raceOther</td>
<td style="text-align: right;">2.299</td>
<td style="text-align: right;">0.820</td>
<td style="text-align: right;">1.015</td>
<td style="text-align: right;">0.310</td>
<td style="text-align: right;">0.333</td>
<td style="text-align: right;">9.724</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cc_bmi25 to &lt;30</td>
<td style="text-align: right;">2.031</td>
<td style="text-align: right;">0.417</td>
<td style="text-align: right;">1.699</td>
<td style="text-align: right;">0.089</td>
<td style="text-align: right;">0.914</td>
<td style="text-align: right;">4.749</td>
</tr>
<tr class="even">
<td style="text-align: left;">cc_bmi30 to &lt;35</td>
<td style="text-align: right;">3.624</td>
<td style="text-align: right;">0.443</td>
<td style="text-align: right;">2.903</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">1.550</td>
<td style="text-align: right;">8.925</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cc_bmi35+</td>
<td style="text-align: right;">7.233</td>
<td style="text-align: right;">0.463</td>
<td style="text-align: right;">4.277</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">3.006</td>
<td style="text-align: right;">18.630</td>
</tr>
<tr class="even">
<td style="text-align: left;">bp_med_useYes</td>
<td style="text-align: right;">1.979</td>
<td style="text-align: right;">0.307</td>
<td style="text-align: right;">2.227</td>
<td style="text-align: right;">0.026</td>
<td style="text-align: right;">1.088</td>
<td style="text-align: right;">3.629</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>For this subset of the data, the true beta value for the systolic mean is … This is much higher than the model which we looked at previously, using all ~50,000 subjects, although it is to be expected since we restricted the data to n=150 samples. Also notice that the significance level</p>
</section>
<section id="regression-calibration-1" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="regression-calibration-1"><span class="header-section-number">8.3</span> Regression Calibration</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a model with predicts the true BP value based on the noisy BP data</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>rcfit<span class="ot">&lt;-</span><span class="fu">lm</span>(bp_sys_mean <span class="sc">~</span> bp_sys_mean_noise_low <span class="sc">+</span> demo_age_years <span class="sc">+</span> demo_gender <span class="sc">+</span> demo_race <span class="sc">+</span> cc_bmi <span class="sc">+</span> bp_med_use, <span class="at">data=</span>subset_nhanes)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rcfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bp_sys_mean ~ bp_sys_mean_noise_low + demo_age_years + 
    demo_gender + demo_race + cc_bmi + bp_med_use, data = subset_nhanes)

Residuals:
    Min      1Q  Median      3Q     Max 
-38.474  -9.810  -1.711   8.647  63.218 

Coefficients:
                            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                 89.56535    2.78350  32.177  &lt; 2e-16 ***
bp_sys_mean_noise_low        0.11877    0.01382   8.596  &lt; 2e-16 ***
demo_age_years               0.40142    0.04192   9.575  &lt; 2e-16 ***
demo_genderWomen            -1.72991    1.27718  -1.354 0.176102    
demo_raceNon-Hispanic Black  0.63160    1.69938   0.372 0.710275    
demo_raceNon-Hispanic Asian -1.84153    2.77735  -0.663 0.507557    
demo_raceHispanic           -0.75026    1.56330  -0.480 0.631462    
demo_raceOther              -0.91382    3.07167  -0.297 0.766191    
cc_bmi25 to &lt;30             -0.60550    1.62407  -0.373 0.709408    
cc_bmi30 to &lt;35              0.23627    1.78558   0.132 0.894777    
cc_bmi35+                   -0.85737    1.93105  -0.444 0.657214    
bp_med_useYes                5.62935    1.68476   3.341 0.000887 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.27 on 588 degrees of freedom
Multiple R-squared:  0.3519,    Adjusted R-squared:  0.3397 
F-statistic: 29.02 on 11 and 588 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>subset_nhanes<span class="sc">$</span>bp_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(rcfit, <span class="at">newdata=</span>subset_nhanes) </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>final.model <span class="ot">=</span> <span class="fu">glm</span>(cc_diabetes <span class="sc">~</span> bp_hat <span class="sc">+</span> demo_age_years <span class="sc">+</span> demo_gender <span class="sc">+</span> demo_race <span class="sc">+</span> cc_bmi <span class="sc">+</span> bp_med_use, <span class="at">family=</span><span class="st">"binomial"</span>,<span class="at">data=</span>subset_nhanes)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cc_diabetes ~ bp_hat + demo_age_years + demo_gender + 
    demo_race + cc_bmi + bp_med_use, family = "binomial", data = subset_nhanes)

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                 -7.69381    2.60474  -2.954  0.00314 ** 
bp_hat                       0.01489    0.02463   0.604  0.54566    
demo_age_years               0.04180    0.01532   2.729  0.00635 ** 
demo_genderWomen            -0.56755    0.27962  -2.030  0.04238 *  
demo_raceNon-Hispanic Black  0.85169    0.36838   2.312  0.02078 *  
demo_raceNon-Hispanic Asian  1.17928    0.71127   1.658  0.09732 .  
demo_raceHispanic            1.29767    0.34073   3.809  0.00014 ***
demo_raceOther               0.79444    0.81493   0.975  0.32963    
cc_bmi25 to &lt;30              0.65948    0.41242   1.599  0.10981    
cc_bmi30 to &lt;35              1.23088    0.43622   2.822  0.00478 ** 
cc_bmi35+                    1.87460    0.45404   4.129 3.65e-05 ***
bp_med_useYes                0.68728    0.32203   2.134  0.03282 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 463.66  on 599  degrees of freedom
Residual deviance: 368.59  on 588  degrees of freedom
AIC: 392.59

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">tidy</span>(final.model, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 33%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">2.605</td>
<td style="text-align: right;">-2.954</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.071</td>
</tr>
<tr class="even">
<td style="text-align: left;">bp_hat</td>
<td style="text-align: right;">1.015</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.604</td>
<td style="text-align: right;">0.546</td>
<td style="text-align: right;">0.967</td>
<td style="text-align: right;">1.065</td>
</tr>
<tr class="odd">
<td style="text-align: left;">demo_age_years</td>
<td style="text-align: right;">1.043</td>
<td style="text-align: right;">0.015</td>
<td style="text-align: right;">2.729</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">1.012</td>
<td style="text-align: right;">1.075</td>
</tr>
<tr class="even">
<td style="text-align: left;">demo_genderWomen</td>
<td style="text-align: right;">0.567</td>
<td style="text-align: right;">0.280</td>
<td style="text-align: right;">-2.030</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.325</td>
<td style="text-align: right;">0.976</td>
</tr>
<tr class="odd">
<td style="text-align: left;">demo_raceNon-Hispanic Black</td>
<td style="text-align: right;">2.344</td>
<td style="text-align: right;">0.368</td>
<td style="text-align: right;">2.312</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">1.140</td>
<td style="text-align: right;">4.864</td>
</tr>
<tr class="even">
<td style="text-align: left;">demo_raceNon-Hispanic Asian</td>
<td style="text-align: right;">3.252</td>
<td style="text-align: right;">0.711</td>
<td style="text-align: right;">1.658</td>
<td style="text-align: right;">0.097</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">11.916</td>
</tr>
<tr class="odd">
<td style="text-align: left;">demo_raceHispanic</td>
<td style="text-align: right;">3.661</td>
<td style="text-align: right;">0.341</td>
<td style="text-align: right;">3.809</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.895</td>
<td style="text-align: right;">7.248</td>
</tr>
<tr class="even">
<td style="text-align: left;">demo_raceOther</td>
<td style="text-align: right;">2.213</td>
<td style="text-align: right;">0.815</td>
<td style="text-align: right;">0.975</td>
<td style="text-align: right;">0.330</td>
<td style="text-align: right;">0.323</td>
<td style="text-align: right;">9.243</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cc_bmi25 to &lt;30</td>
<td style="text-align: right;">1.934</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">1.599</td>
<td style="text-align: right;">0.110</td>
<td style="text-align: right;">0.877</td>
<td style="text-align: right;">4.478</td>
</tr>
<tr class="even">
<td style="text-align: left;">cc_bmi30 to &lt;35</td>
<td style="text-align: right;">3.424</td>
<td style="text-align: right;">0.436</td>
<td style="text-align: right;">2.822</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: right;">1.484</td>
<td style="text-align: right;">8.308</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cc_bmi35+</td>
<td style="text-align: right;">6.518</td>
<td style="text-align: right;">0.454</td>
<td style="text-align: right;">4.129</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">2.749</td>
<td style="text-align: right;">16.476</td>
</tr>
<tr class="even">
<td style="text-align: left;">bp_med_useYes</td>
<td style="text-align: right;">1.988</td>
<td style="text-align: right;">0.322</td>
<td style="text-align: right;">2.134</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">1.060</td>
<td style="text-align: right;">3.758</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>diabetes_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(bp_hat <span class="sc">~</span> cc_diabetes, <span class="at">data =</span> subset_nhanes)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>diabetes_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  bp_hat by cc_diabetes
t = -7.6016, df = 110, p-value = 1.047e-11
alternative hypothesis: true difference in means between group No and group Yes is not equal to 0
95 percent confidence interval:
 -11.246486  -6.595121
sample estimates:
 mean in group No mean in group Yes 
         122.6628          131.5836 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Correlation between BP_noise and BP_hat:"</span>, <span class="fu">cor</span>(subset_nhanes<span class="sc">$</span>bp_sys_mean_noise_low, subset_nhanes<span class="sc">$</span>bp_hat)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Correlation between BP_noise and BP_hat: 0.626950413178945"</code></pre>
</div>
</div>
<p>Fix Standard Errors:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#warning = False</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">43</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>bootstrap.functionV2<span class="ot">&lt;-</span><span class="cf">function</span>(dat,inds){</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    subset_nhanes.boot<span class="ot">&lt;-</span>dat[inds,]</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    rcfit.boot<span class="ot">&lt;-</span><span class="fu">lm</span>(bp_sys_mean <span class="sc">~</span> bp_sys_mean_noise_low <span class="sc">+</span> demo_age_years <span class="sc">+</span> demo_gender <span class="sc">+</span> demo_race <span class="sc">+</span> cc_bmi <span class="sc">+</span> bp_med_use, <span class="at">data=</span>subset_nhanes.boot)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    subset_nhanes.boot<span class="sc">$</span>bp_hat<span class="ot">&lt;-</span><span class="fu">predict</span>(rcfit.boot,<span class="at">newdata=</span>subset_nhanes.boot)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    final.model<span class="ot">=</span> <span class="fu">glm</span>(cc_diabetes <span class="sc">~</span> bp_hat, <span class="at">family=</span><span class="st">"binomial"</span>, <span class="at">data=</span>subset_nhanes.boot)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(final.model<span class="sc">$</span>coef)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>my.boot<span class="ot">&lt;-</span><span class="fu">boot</span>(subset_nhanes, bootstrap.functionV2, <span class="at">R=</span><span class="dv">500</span>)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>bsSD <span class="ot">&lt;-</span> <span class="fu">apply</span>(my.boot<span class="sc">$</span>t,<span class="dv">2</span>,sd)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>bsSD</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.70784464 0.01331138</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>t.stat<span class="ot">&lt;-</span><span class="fu">coef</span>(final.model)<span class="sc">/</span>bsSD</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>t.stat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                (Intercept)                      bp_hat 
                -4.50498173                  1.11829331 
             demo_age_years            demo_genderWomen 
                 0.02447299                -42.63630869 
demo_raceNon-Hispanic Black demo_raceNon-Hispanic Asian 
                 0.49869177                 88.59155106 
          demo_raceHispanic              demo_raceOther 
                 0.75983012                 59.68157177 
            cc_bmi25 to &lt;30             cc_bmi30 to &lt;35 
                 0.38614475                 92.46793953 
                  cc_bmi35+               bp_med_useYes 
                 1.09764009                 51.63115902 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>p.value.bp <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(t.stat[<span class="st">'bp_hat'</span>]))</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p.value.bp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   bp_hat 
0.2634417 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>conf.low <span class="ot">&lt;-</span> <span class="fl">1.015</span> <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span><span class="fl">0.01331138</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>conf.high <span class="ot">&lt;-</span> <span class="fl">1.015</span> <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span><span class="fl">0.01331138</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>conf.low</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9889097</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>conf.high</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.04109</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./add_noise.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Creating “Noisy” Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>